# forward-all.conf
# Example config showing client routing/filtering for all traffic, simplest setup
# ONLY USE IF YOU TRUST YOUR CLIENTS 100%
[Interface]
Address = 192.168.11.1/24
ListenPort = 51822
SaveConfig = false
PrivateKey = PRIVKEY

# Enable in /etc/sysctl.conf or use this line
#PreUp = sysctl -w net.ipv4.ip_forward=1

# Forward all traffic (relies on client Allowed IPs)
PostUp = iptables -A FORWARD -i wg0 -j ACCEPT
# NAT for internet
PostUp = iptables -t nat -A POSTROUTING -s 192.168.11.0/24 -j MASQUERADE

# Cleanup
PostDown = iptables -D FORWARD -i wg0 -j ACCEPT

PostDown = iptables -t nat -D POSTROUTING -s 192.168.11.0/24 -j MASQUERADE

# Clients
# /24 is weak, does not enforce exact IPs, use /32 if that is desired behavior
# Reserve .2-.9 for me
# dguy-desktop
[Peer]
PublicKey = PUBKEY
PresharedKey = PSK
AllowedIPs = 192.168.11.2/24
# dguy-laptop
[Peer]
PublicKey = PUBKEY
PresharedKey = PSK
AllowedIPs = 192.168.11.3/24
# dguy-phone
[Peer]
PublicKey = PUBKEY
PresharedKey = PSK
AllowedIPs = 192.168.11.4/24

# butters-desktop
[Peer]
PublicKey = PUBKEY
PresharedKey = PSK
AllowedIPs = 192.168.11.11/24

# greg-laptop
[Peer]
PublicKey = PUBKEY
PresharedKey = PSK
AllowedIPs = 192.168.11.12/24
